# 數據可視化功能說明

## 圓餅圖功能

### 概述
新聞界面現在包含一個現代化的圓餅圖，自動分析並顯示今日新聞的類型分佈。

### 功能特點

#### 1. 自動分類
系統會根據新聞標題和摘要中的關鍵詞，自動將新聞分類到以下類別：

| 類別 | 顏色 | 關鍵詞示例 |
|------|------|-----------|
| 🔬 科技 | 藍色 #3498db | AI、人工智能、電腦、手機、5G、晶片 |
| 💰 財經 | 橙色 #f39c12 | 股市、經濟、金融、投資、台股、美股 |
| ⚽ 體育 | 綠色 #2ecc71 | 足球、籃球、棒球、奧運、比賽 |
| 🎬 娛樂 | 紅色 #e74c3c | 電影、音樂、明星、演唱會、戲劇 |
| 🏥 健康 | 紫色 #9b59b6 | 醫療、疫情、病毒、疫苗、醫院 |
| 🌍 國際 | 青色 #1abc9c | 美國、中國、日本、歐洲、外交 |
| 🏛️ 政治 | 深橙 #e67e22 | 選舉、政府、總統、立法、政策 |
| 🎓 教育 | 深綠 #27ae60 | 學校、大學、考試、學生、教師 |
| 📋 其他 | 灰色 #95a5a6 | 未匹配到上述類別的新聞 |

#### 2. 視覺設計

**環形圖設計**
- 使用環形圖（Donut Chart）而非傳統圓餅圖
- 中心顯示新聞總數
- 外環顯示各類別佔比

**配色方案**
- 語義化配色：每個類別使用符合其主題的顏色
- 支持深色/淺色主題自動適配
- 高對比度，易於區分

**文字標註**
- 類別名稱標註在扇區外側
- 佔比超過 5% 的類別顯示百分比
- 使用白色粗體文字確保可讀性

#### 3. 互動功能

**點擊篩選**
```
點擊類別按鈕 → 自動篩選該類別新聞 → 更新顯示
```

例如：
- 點擊「科技: 10條 (50%)」按鈕
- 界面只顯示科技類新聞
- 狀態欄顯示「📂 篩選『科技』類別：找到 10 條新聞」

**取消篩選**
- 點擊底部「📋 顯示全部」按鈕
- 恢復顯示所有新聞

#### 4. 數據總結

圓餅圖下方顯示：
```
今日共發佈 50 條新聞，涵蓋 6 種分類
```

以及各類別的詳細統計：
```
科技: 25條 (50.0%)  財經: 10條 (20.0%)  體育: 8條 (16.0%)
娛樂: 4條 (8.0%)    健康: 2條 (4.0%)    其他: 1條 (2.0%)
```

### 使用場景

#### 場景 1：快速了解新聞分佈
```
1. 搜索「今日新聞」
2. 查看圓餅圖
3. 一眼看出哪個類別新聞最多
```

#### 場景 2：專注特定類別
```
1. 搜索「台灣」
2. 查看圓餅圖發現「政治」類佔 40%
3. 點擊「政治」按鈕
4. 只查看政治相關新聞
```

#### 場景 3：對比不同主題
```
1. 搜索「科技」→ 查看分佈
2. 搜索「娛樂」→ 查看分佈
3. 對比兩次搜索的類別分佈差異
```

### 技術實現

#### 使用的庫
- **matplotlib**：繪製圓餅圖
- **FigureCanvasTkAgg**：將 matplotlib 圖表嵌入 tkinter
- **PIL/Pillow**：圖像處理

#### 分類算法
```python
def analyze_news_categories(news_data):
    # 1. 定義類別關鍵詞
    category_keywords = {
        '科技': ['AI', '人工智能', '電腦', ...],
        '財經': ['股市', '經濟', '金融', ...],
        ...
    }
    
    # 2. 遍歷每條新聞
    for news in news_data:
        text = news['title'] + ' ' + news['snippet']
        
        # 3. 匹配關鍵詞
        for category, keywords in category_keywords.items():
            if any(keyword in text for keyword in keywords):
                # 歸類到該類別
                break
    
    # 4. 返回統計結果
    return category_count
```

#### 圖表繪製
```python
# 創建環形圖
wedges, texts, autotexts = ax.pie(
    values,
    labels=categories,
    colors=colors,
    autopct='%1.1f%%',
    startangle=90,
    wedgeprops=dict(width=0.5)  # 環形效果
)

# 中心文字
ax.text(0, 0, f'共 {total} 條\n新聞', 
        ha='center', va='center')
```

### 自定義配置

#### 修改類別關鍵詞
編輯 `news_gui.py` 中的 `analyze_news_categories` 方法：

```python
category_keywords = {
    '科技': ['AI', '人工智能', '你的關鍵詞'],
    # 添加更多關鍵詞...
}
```

#### 修改配色方案
編輯 `create_pie_chart` 方法中的 `color_map`：

```python
color_map = {
    '科技': '#你的顏色代碼',
    '財經': '#你的顏色代碼',
    # 修改顏色...
}
```

#### 調整圖表大小
修改 `Figure` 的 `figsize` 參數：

```python
fig = Figure(figsize=(寬度, 高度), dpi=解析度)
```

### 注意事項

1. **關鍵詞匹配**
   - 使用簡單的關鍵詞匹配，可能不夠精確
   - 一條新聞只會被歸類到第一個匹配的類別
   - 建議使用更具體的搜索詞以獲得更準確的分類

2. **性能考慮**
   - 圖表繪製需要一定時間
   - 新聞數量過多時可能影響性能
   - 建議每次搜索不超過 50 條新聞

3. **中文字體**
   - matplotlib 可能需要配置中文字體
   - 如果顯示亂碼，請安裝中文字體包

### 未來改進

- [ ] 使用機器學習模型進行更精確的分類
- [ ] 支持自定義類別和關鍵詞
- [ ] 添加時間序列圖表（顯示不同時間的分佈變化）
- [ ] 支持導出圖表為圖片
- [ ] 添加更多圖表類型（柱狀圖、折線圖等）
- [ ] 支持多維度分析（來源 × 類別）

## 常見問題

### Q: 為什麼某些新聞被歸類為「其他」？
A: 如果新聞的標題和摘要中沒有匹配到任何預定義的關鍵詞，就會被歸類為「其他」。您可以添加更多關鍵詞來改善分類準確度。

### Q: 可以添加新的類別嗎？
A: 可以！編輯 `news_gui.py` 中的 `category_keywords` 和 `color_map` 字典，添加新的類別和對應的關鍵詞及顏色。

### Q: 圓餅圖顯示不正常怎麼辦？
A: 請確保已安裝 matplotlib：`pip install matplotlib>=3.7.0`

### Q: 如何隱藏圓餅圖？
A: 在 `display_news` 方法中註釋掉 `self.create_pie_chart(self.scrollable_frame)` 這一行。

### Q: 篩選後如何返回？
A: 點擊底部的「📋 顯示全部」按鈕即可取消篩選，顯示所有新聞。
